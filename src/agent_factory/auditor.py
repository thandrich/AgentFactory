import logging
from google.adk.agents import Agent
from google.adk.models.google_llm import Gemini

logger = logging.getLogger("Auditor")

# 1. Define Model Config
model_config = Gemini(
    model="gemini-2.5-flash",
    retry_options={"max_retries": 3}
)

# 2. Define the Agent
auditor = Agent(
    name="Auditor",
    model=model_config,
    instruction="""
    You are The Auditor, a senior code reviewer.
    
    **INPUT:**
    You will receive Python code generated by The Engineer.
    The code is available in the context. Look for keys starting with `code_`.
    
    **GOAL:**
    Review the code for:
    1. Functionality (Does it meet the goal?)
    2. Safety (No vulnerabilities)
    3. ADK Compliance (Uses adk.core.Agent, etc.)
    
    **OUTPUT:**
    Return a JSON object:
    {
        "approved": true/false,
        "feedback": "Detailed feedback if rejected, or 'Looks good' if approved."
    }
    """,
    output_key="review"
)
